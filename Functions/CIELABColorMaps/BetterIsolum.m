function [cmap] = BetterIsolum(varargin)
  %UNTITLED Summary of this function goes here
  %   Detailed explanation goes here
  
  if nargin > 0 && ~isempty(varargin{1})
    chromaK = varargin{1};
  else
    chromaK = 1;
  end
  
  isolumEqLab = [69.6043620968584 -17.5170810479813 -28.3249189494676;69.5462382032765 -17.0397221578996 -27.9100074739788;69.4888955275376 -16.5644712486954 -27.4939666691344;69.4323398565662 -16.0913431206313 -27.0767969460308;69.3765764230167 -15.6203574920091 -26.658494669237;69.3216086798044 -15.1515429939991 -26.239066829397;69.2674383920436 -14.6849166799973 -25.8185144972012;69.214070896108 -14.2205144395507 -25.3968395138073;69.1615128019095 -13.7583552125104 -24.9740357382706;69.1097640692804 -13.2984642149355 -24.5501157869695;69.0588294291676 -12.8408588300627 -24.1250802644536;69.008713900785 -12.3855784804924 -23.6989276029472;68.9594202423338 -11.9326390849529 -23.2716666808665;68.9109492102947 -11.4820625702509 -22.8433006018906;68.8633104649859 -11.033880555127 -22.413827639775;68.8165024697994 -10.5881098173184 -21.9832619542546;68.7705280047715 -10.1447867789742 -21.5516028390752;68.7253935481699 -9.70392124398095 -21.1188550663718;68.6810971385102 -9.26555091878456 -20.6850302572435;68.6376477735727 -8.82970149194456 -20.2501273652219;68.5950438606772 -8.39639447406398 -19.814160040039;68.5532889617728 -7.96565784774023 -19.3771297489545;68.5123864573173 -7.53751226720267 -18.9390458144558;68.4723404411211 -7.11199011911656 -18.4999129963051;68.4331513645405 -6.68911094070657 -18.0597444438868;68.3948225016487 -6.2689149353331 -17.6185442448676;68.3573524001356 -5.85140405767892 -17.1763252154199;68.3207467288252 -5.43661910734794 -16.7330879973461;68.2850096873779 -5.02458520992571 -16.2888397512577;68.2501389343441 -4.61532735176262 -15.8435989301693;68.2161391514534 -4.20887260175423 -15.3973705148846;68.183008559381 -3.80524659599107 -14.9501704931463;68.1507521377922 -3.40447489468959 -14.502005809672;68.1193746947621 -3.00659462353975 -14.052880886205;68.0888709104839 -2.61161667862009 -13.6028237037787;68.0592474768814 -2.21958164585107 -13.1518300924976;68.0305036928688 -1.83050816118613 -12.6999242976747;68.002642006612 -1.44442918957449 -12.2471107286768;67.9756614469298 -1.06136589134148 -11.7934071424499;67.9495670147579 -0.68134992518265 -11.3388243912907;67.9243559287773 -0.304407332122891 -10.883377468723;67.9000316435303 0.0694334222770543 -10.427082645395;67.8765974528967 0.440141128625338 -9.96994513659024;67.8540510108019 0.807690413741569 -9.51199010425547;67.8323927081581 1.17206025074029 -9.05322646377014;67.8116245968862 1.53321589999789 -8.59367584234976;67.7917500475069 1.8911238027387 -8.13334235273031;67.7727653676212 2.24576583130287 -7.67225332481876;67.7546735878268 2.59711183325773 -7.21041953777988;67.7374760121717 2.94512941961467 -6.74785993283487;67.7211704933789 3.28979359281584 -6.28458655381756;67.7057592615195 3.63107541712643 -5.82062173676205;67.6912448360397 3.96894283882115 -5.35597763846447;67.6776231083111 4.30337438294803 -4.89067617181784;67.6648993843776 4.63433157592963 -4.42473340927321;67.6530674758848 4.96179651415529 -3.95816828767881;67.642133042207 5.28573521724707 -3.49099764357508;67.6320930438353 5.60612133758914 -3.02324477764502;67.6229528563534 5.92291717036381 -2.55491517238287;67.6147059833383 6.23610892199089 -2.086045451194;67.6073577713543 6.54564964817178 -1.61663764526667;67.600902363996 6.85153138863026 -1.14672813569072;67.5953433322106 7.15370888289046 -0.676325183701909;67.5906805737027 7.45216301623353 -0.205451036590754;67.5869164049069 7.74685479377313 0.26587620279872;67.5840451797521 8.03776473341433 0.73763183181268;67.5820699021457 8.32485992726184 1.20980073522368;67.5809889607744 8.60811109471077 1.6823563193427;67.5808047142502 8.8874882283061 2.15528712380557;67.5815108886777 9.16297377299946 2.62856379630805;67.5831167758349 9.43451734541812 3.1021717051285;67.5856111009781 9.70211197267856 3.57608135486227;67.5890019829851 9.96571524497208 4.05028582453364;67.5932819429504 10.2253105385747 4.52474616949059;67.598459909895 10.4808483776562 4.99946351606424;67.6045242735142 10.7323253668639 5.47439703550372;67.611482399182 10.9796945181321 5.94953646658296;67.6193296210211 11.2229413217306 6.42484836059971;67.6280676368137 11.4620261670618 6.90032563221765;67.6376943765481 11.6969285444629 7.37593932704159;67.648211979955 11.9276114935756 7.85167126407849;67.6596151325875 12.154054832295 8.32750053001832;67.6719068299231 12.3762330463399 8.80340221214286;67.6850850577608 12.5941119266149 9.27935621001978;67.6991492036233 12.8076673162379 9.75533799697241;67.7140976855338 13.0168696040504 10.2313361913719;67.7299311545051 13.2216970766744 10.7073193999505;67.7466492111776 13.4221167671865 11.1832682992512;67.7642506455418 13.6181018275328 11.6591642106719;67.7827311576177 13.8096351298398 12.1349839913891;67.802094137463 13.9966831071257 12.6107071204814;67.8223384543565 14.1792150128723 13.0863133039339;67.8434602396485 14.3572159271795 13.561782991532;67.8654625987859 14.5306522425738 14.0370919780851;67.8883424969009 14.6994994550122 14.5122188126426;67.9120971114908 14.8637400292839 14.9871517723597;67.9367278826922 15.0233445161908 15.4618477870308;67.9622349638882 15.1782813214804 15.9363187751812;67.9886174964793 15.3285347567589 16.4105195104966;68.0158725464702 15.4740763971197 16.88444854748;68.0439997839682 15.614887558535 17.3580734612352;68.0729972165162 15.750942671359 17.8313743310905;68.1028641680758 15.8822205570772 18.3043354417704;68.1336002626296 16.0087005713008 18.7769369889576;68.1652042201524 16.1303582571927 19.2491599103881;68.1976749953734 16.2471708545014 19.7209837843132;68.2310125030984 16.3591204607075 20.192388191946;68.2652145196234 16.4661812119915 20.6633626538711;68.3002804930314 16.5683357482624 21.1338815475174;68.3362090674914 16.6655616319888 21.6039482709249;68.3730003096885 16.7578478511685 22.0734973699675;68.4106517169683 16.8451669369151 22.5425485748295;68.4491629067849 16.9275038601157 23.0110776979769;68.4885318520195 17.0048370513846 23.4790779001314;68.5287576130493 17.0771527340098 23.9465134741483;68.5698398038007 17.1444384483254 24.4133712595565;68.611775174348 17.2066704648118 24.8796441935637;68.6545631998326 17.2638359044834 25.3453104176017;68.6982038421031 17.3159225885092 25.81035580519;68.742694792871 17.3629109441208 26.274763318629;68.7880357148643 17.4047858016692 26.7385233241817;68.834226508863 17.4415320603412 27.20161689381;68.8812645048297 17.4731376828112 27.6640486111626;68.9291452395619 17.4995976970015 28.1257827988199;68.9778711039262 17.5209002199737 28.5867790193049;69.0274409228246 17.5370237851062 29.0470753492711;69.0778497510792 17.5479693175015 29.5066373814214;69.1291000827382 17.5537141189483 29.9654586633134;69.1811884341966 17.5542579568768 30.4235223373696;69.2341110453943 17.5495971032935 30.8808060291762;69.2878700422279 17.5397117722197 31.3373270120035;69.3424628382337 17.5245991603772 31.7930384920015;69.397886707958 17.5042526559327 32.2479558963822;69.4541420429172 17.4786742405506 32.7020552517702;69.5112248334716 17.4478465538613 33.1553389972379;69.5691355272821 17.4117733345992 33.6077790284616;69.6278691397535 17.3704496593713 34.0593744916011;69.6874264650411 17.3238670515353 34.5101383188158;69.7478060597993 17.2720292439938 34.9600268522376;69.8090052251994 17.2149307409833 35.4090438146026;69.8710206262614 17.1525736499639 35.8572093581414;69.9338526461993 17.0849591627245 36.3044672299226;69.9974950696153 17.0120930652571 36.7508379297208;70.0619528316651 16.9339552963645 37.196317308938;70.1272195513403 16.850571032378 37.6408853598855;70.193289255896 16.761936037115 38.0845624858998;70.2601682190857 16.668051413743 38.5272953529594;70.3278477869217 16.5689238826006 38.9691291783444;70.3963279431954 16.4645558391743 39.4100550934688;70.4656063067465 16.354958402602 39.8500222503888;70.5356807331375 16.240135894727 40.2890611092459;70.6065471800525 16.1200955440469 40.7271685809387;70.678205571527 15.9948467382199 41.1643389929953;70.7506521557847 15.8643980183781 41.6005574042289;70.8238828299469 15.7287583361127 42.0358350388625;70.8978982684569 15.5879410226476 42.4701625919268;70.972691706572 15.4419601338309 42.9035417468143;71.0482645975369 15.2908162588524 43.3359747664005;71.1246113492797 15.1345355697411 43.7674430924259;71.2017307142139 14.9731237717736 44.197968148677;71.2796179467836 14.806600337622 44.6275395454452;71.3582697011628 14.6349809196285 45.0561559424454;71.4376864173373 14.458275991275 45.4838090112372;71.5178622743785 14.2765058283189 45.9105211478658;71.5987947117764 14.0896902721805 46.3362815173981;71.6804809603432 13.8978459971595 46.761077596137;71.762916483627 13.700988809662 47.1849411202248;71.8460991967028 13.4991436106632 47.6078489308399;71.9300246309243 13.2923327221634 48.0298035848919;72.0146902801365 13.0805691118701 48.4508316992476;72.1000911196328 12.8638834436714 48.8709081071335;72.1862273206777 12.6422892569774 49.2900503107925;72.27309167528 12.4158188877433 49.7082541501793;72.3606808780251 12.1844913828122 50.1255460089052;72.4489906317901 11.948338749285 50.541895744453;72.5380218809507 11.7073719598824 50.9573344785908;72.6277649846123 11.461632105885 51.3718474226541;72.7182194563654 11.2111326493339 51.785475779501;72.80937723568 10.955920828043 52.1981604110187;72.9012405916378 10.6960036211717 52.6099547095326;72.9938007327515 10.4314223363052 53.020845807263;73.0870550489982 10.1621978877024 53.430870028249;73.1809963252415 9.88836953988109 53.8400154318716;73.2756268333126 9.60996026084665 54.2482603867251;73.370937410155 9.32700461034253 54.6556471969717;73.4669239327827 9.03953747109704 55.0621611393112;73.5635821904319 8.74758343023396 55.4678472105416;73.6609100917538 8.45118145903484 55.8726457054751;73.7589004559217 8.15036135909786 56.276619059415;73.8575496996273 7.84515708024752 56.679772813066;73.9568530795585 7.53560905356804 57.0820736710575;74.0568065246867 7.22174253937519 57.4835655059282;74.157402750131 6.90360102523752 57.8842495131441;74.2586398742032 6.58121668381861 58.2841350026155;74.3605115600891 6.25462599933818 58.6832341449811;74.4630150260095 5.92386491136143 59.0815277793896;74.5661434317361 5.58896607245368 59.4790778587636;74.6698906287988 5.24997561208818 59.8758586330295;74.7742533565607 4.9069332889109 60.2718507567311;74.8792257438538 4.55987069395808 60.6671149784436;74.9848053039829 4.20881982964799 61.0616480860297;75.090982826518 3.85383202941703 61.4554458825837;75.1977558060682 3.49494609922246 61.8485166385512;75.3051202440726 3.13219141810678 62.2408835705055;75.413066396693 2.765612724143 62.6325669515195;75.521592501725 2.39525659309037 63.0235424042306;75.6306930154077 2.02115818186482 63.4138235950266;75.7403624383931 1.6433513291903 63.8034752362098;75.8505917767914 1.26188909402214 64.1924625627227;75.9613812001215 0.876802337582638 64.580812660661;76.0727222948515 0.48814541669312 64.9684656605938;76.1846093434043 0.0959440214385876 65.3555517060788;76.2970382012439 -0.299749378493086 65.7419991826557;76.4100028130039 -0.698899264449937 66.1278510066915;76.5234976347742 -1.10145526567551 66.513094563896;76.6375175600293 -1.50738647785548 66.8977510956382;76.7520541258376 -1.91664299868899 67.2818598819945;76.8671064321806 -2.32918457919407 67.6653726783574;76.982665845683 -2.74496851873601 68.0483579335741;77.0987287044792 -3.16395476897535 68.430782302015;77.2152861231556 -3.58609648886565 68.8126867490945;77.3323347457449 -4.01135226204952 69.194058172178;77.4498693076165 -4.43968588680554 69.5749386156481;77.5678838684564 -4.87104427160545 69.9552840337646;77.6863698650983 -5.30539393017038 70.3351901135903;77.8053254537497 -5.74269527612054 70.7146080268547;77.9247444331431 -6.18289495658281 71.0935696024434;78.0446201016293 -6.62595047011633 71.4720343140681;78.1649468206664 -7.07182883762442 71.850039121346;78.2857176895724 -7.52048341226691 72.2276463371073;78.4069285172032 -7.97187693284035 72.6048350663538;78.5285710314712 -8.4259620930604 72.9816253893481;78.6506416358403 -8.88269935809571 73.358009020304;78.7731346223432 -9.34204358702045 73.7339795795024;78.8960435800217 -9.80395800883566 74.1095812128017;79.0193638354972 -10.2683956764629 74.4847886111979;79.1430871852799 -10.7353214209648 74.8596646544489;79.267210518638 -11.2046841595227 75.2341258331988;79.3917267883209 -11.6764667579829 75.6083657297543;79.5166301366897 -12.1505921868178 75.9821427445968;79.6419176433254 -12.6270478269607 76.3556386683168;79.7675804042116 -13.1057841644747 76.7288013633164;79.893612815403 -13.5867686619739 77.101717434186;80.0200117128869 -14.0699571552703 77.47435818095;80.1467701210774 -14.5553075453952 77.8466998596257;80.2738842105828 -15.0427679268005 78.2186496607629;80.4013456217226 -15.5323306647616 78.5904803072744;80.5291496894689 -16.0239404719714 78.9620683678899;80.6572953664102 -16.5175347341783 79.333182292941;80.7857695301201 -17.0131291914081 79.7043293037774;80.9145736534152 -17.5106409752442 80.0751150364344;81.0436996217868 -18.0100515498082 80.4457001018933;81.1731419752413 -18.5113176854636 80.8160622923519;81.3028956642175 -19.0144105868322 81.1862452181035;81.4361130192025 -19.4935315628293 81.313739496278;81.5701798195904 -19.9697236834236 81.3974384489488];
  
  if chromaK ~= 1
    isolumEqLab = isolumEqLab .* [1, chromaK, chromaK];
  end
  
  cmap = applycform(isolumEqLab,...
    makecform('lab2srgb', 'AdaptedWhitePoint', whitepoint('D65')));
end

